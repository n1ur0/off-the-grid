# Redis configuration for Off the Grid application
# Optimized for session management and caching

# Basic settings
port 6379
bind 0.0.0.0
protected-mode yes
requirepass changeme-in-production

# Memory management
maxmemory 256mb
maxmemory-policy allkeys-lru

# Persistence settings for session reliability
save 900 1      # Save if at least 1 key changed in 900 seconds
save 300 10     # Save if at least 10 keys changed in 300 seconds  
save 60 10000   # Save if at least 10000 keys changed in 60 seconds

# AOF persistence for better durability
appendonly yes
appendfilename "appendonly.aof"
appendfsync everysec

# Security
rename-command FLUSHDB ""
rename-command FLUSHALL ""
rename-command KEYS ""
rename-command CONFIG "CONFIG_9a8f7e2d1c"

# Logging
loglevel notice
logfile /var/log/redis/redis-server.log

# Client settings
timeout 300
tcp-keepalive 300

# Database settings
databases 16

# Key naming conventions for Off the Grid:
# session:{user_id} - User session data
# grid_cache:{grid_id} - Grid order cache
# user_cache:{wallet_address} - User data cache
# ws_connections:{user_id} - WebSocket connection tracking
# rate_limit:{ip_address} - Rate limiting
# temp:{key} - Temporary data with TTL